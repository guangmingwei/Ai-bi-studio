# AI动态图表生成功能 - 使用指南

## 🎯 功能概述

AI助手现在可以根据用户的自然语言请求，**自动生成数据可视化图表**。当用户需要统计分析、查看趋势或数据分布时，AI会自动调用后端数据API，生成相应的ECharts图表，并以弹窗形式展示。

## 📊 支持的数据类型

### 1. 摄像头统计 (`/api/stats/cameras`)
- 摄像头总数、在线/离线数量
- 状态变化趋势（7天）
- 在线/离线分布

### 2. 告警统计 (`/api/stats/alerts`)
- 告警总数、严重/警告/信息级别
- 告警趋势（按天、按小时）
- 告警类型分布

### 3. 巡逻统计 (`/api/stats/patrol`)
- 巡逻摄像头数量
- 巡逻切换次数和频率
- 巡逻趋势（24小时）

### 4. 系统性能 (`/api/stats/system`)
- CPU、内存、磁盘使用率
- 网络上传/下载速度
- 性能趋势（实时监控）

## 🗣️ 使用示例

用户只需用自然语言向AI助手提问，AI会自动识别需求并生成图表：

### 趋势分析类
- "显示最近一周的告警趋势"
- "摄像头在线率变化图"
- "系统CPU使用率走势"
- "24小时告警分布情况"

### 统计对比类
- "各类告警数量对比"
- "摄像头在线离线对比"
- "不同级别告警统计"

### 分布展示类
- "告警类型占比"
- "摄像头状态分布"
- "各类告警的百分比"

### 性能监控类
- "当前系统性能状态"
- "CPU和内存使用情况"
- "网络流量分析"

## 🎨 支持的图表类型

### Line (折线图)
✅ **适用场景**：趋势分析、时间序列
- 告警趋势
- 性能走势
- 状态变化

### Bar (柱状图)
✅ **适用场景**：数量对比、类别对比
- 各类告警数量
- 不同时段对比
- 分类统计

### Pie (饼图)
✅ **适用场景**：占比分布、百分比
- 告警类型分布
- 摄像头状态占比
- 资源使用分布

### Scatter (散点图)
✅ **适用场景**：相关性分析
- 多维度数据关系
- 异常值检测

### Radar (雷达图)
✅ **适用场景**：多维度评估
- 系统综合评估
- 多指标对比

## 💡 工作原理

```
用户提问
   ↓
AI识别需求类型（统计/趋势/分布）
   ↓
AI调用 generateChart 工具
   ├─ dataSource: 选择数据API
   ├─ chartType: 选择图表类型
   ├─ title: 生成中文标题
   └─ dataMapping: 配置数据映射
   ↓
后端获取实时数据
   ↓
前端渲染ECharts图表
   ↓
弹窗展示（可全屏/下载）
```

## 🔧 技术实现

### 后端
- **数据API**: 4个统计端点提供实时数据
- **AI Tool**: `generateChart` action定义在 `useAppActions.ts`
- **System Prompt**: 指导AI何时使用图表工具

### 前端
- **DynamicUIRenderer**: 动态渲染组件（支持图表/表格/自定义）
- **ChartModal**: 图表展示弹窗（支持全屏/下载）
- **ECharts**: 强大的图表库，暗黑科技风格主题

## 🎯 最佳实践

1. **明确需求**：清晰描述需要查看的数据
   - ✅ "显示最近7天的告警趋势图"
   - ❌ "给我看看数据"

2. **指定时间**：如果需要特定时间范围
   - "最近一周"、"过去24小时"、"今天"

3. **说明目的**：让AI选择最合适的图表类型
   - "对比分析" → 柱状图
   - "趋势变化" → 折线图
   - "占比分布" → 饼图

## 🚀 后续扩展

未来可以支持：
- 📈 更多图表类型（热力图、树图、桑基图）
- 🔄 实时数据刷新
- 💾 图表保存和分享
- 📊 自定义图表配置
- 🤖 AI生成完整的React组件代码

---

**享受智能数据可视化！** 🎉

